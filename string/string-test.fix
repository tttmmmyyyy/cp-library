module CPLib.String.Test;

// https://atcoder.jp/contests/language-test-202505/submissions/68411508

import CPLib.String;

test : IO ();
test = test_sa;; test_lcp;; test_z;

test_sa : IO ();
test_sa = (
    let s = "abracadabra";
    let sa = s.calc_suffix_array;
    assert_eq(|_|"test_sa", sa, [10, 7, 0, 3, 5, 8, 1, 4, 6, 9, 2]);;

    let sa = s.get_bytes.pop_back.map(to_I64).calc_suffix_array_any;
    assert_eq(|_|"test_sa", sa, [10, 7, 0, 3, 5, 8, 1, 4, 6, 9, 2]);;

    pure()
);

test_lcp : IO ();
test_lcp = (
    let s = "abracadabra";
    let sa = s.calc_suffix_array;
    let lcp = s.calc_lcp_array(sa);
    assert_eq(|_|"test_lcp", lcp, [1, 4, 1, 1, 0, 3, 0, 0, 0, 2]);;
    pure()
);

test_z : IO ();
test_z = (
    let s = "abracadabra";
    let z = s.calc_z_array;
    assert_eq(|_|"test_z", z, [11, 0, 0, 1, 0, 1, 0, 4, 0, 0, 1]);;
    pure()
);